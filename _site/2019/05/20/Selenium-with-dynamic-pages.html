<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" /> <!--[if lte IE 9]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]--> <meta name="author" content="Yu-Hsien Liu"> <meta name="keywords" content="pythonseleniumen"> <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600|Droid+Sans+Mono' rel='stylesheet' type='text/css'> <link rel="shortcut icon" href="/assets/img/website_icon.png" /> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://localhost:4000/2019/05/20/Selenium-with-dynamic-pages.html"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Selenium with dynamic pages | Yu-Hsien’s Blog</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Selenium with dynamic pages" /> <meta name="author" content="Yu-Hsien Liu" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="notes on selenium" /> <meta property="og:description" content="notes on selenium" /> <link rel="canonical" href="http://localhost:4000/2019/05/20/Selenium-with-dynamic-pages.html" /> <meta property="og:url" content="http://localhost:4000/2019/05/20/Selenium-with-dynamic-pages.html" /> <meta property="og:site_name" content="Yu-Hsien’s Blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2019-05-20T00:00:00-04:00" /> <script type="application/ld+json"> {"url":"http://localhost:4000/2019/05/20/Selenium-with-dynamic-pages.html","headline":"Selenium with dynamic pages","dateModified":"2019-05-20T00:00:00-04:00","datePublished":"2019-05-20T00:00:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/05/20/Selenium-with-dynamic-pages.html"},"author":{"@type":"Person","name":"Yu-Hsien Liu"},"description":"notes on selenium","@type":"BlogPosting","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Yu-Hsien's Blog" /> <script src="/assets/js/prefixfree.js"></script> </head> <body> <aside id="sidebar" class="open"> <div id="sidebar-left"> <a id="sidebar-avatar" href="/"> <img id="sidebar-avatar-img" alt="" src="https://avatars0.githubusercontent.com/u/19959065?s=460&v=4"/> </a> <div id="sidebar-social"> <a href="/pages/feed.xml" class="sidebar-social-icon feed"></a> <a href="mailto:liu.yuhsien81@gmail.com" class="sidebar-social-icon email"></a> <!-- Generate icon by yourself https://icomoon.io/app/#/select --> <a href="https://github.com/yuhsienliu" class="sidebar-social-icon github" target="_blank"></a> <a href="https://www.linkedin.com/in/yuhsienliu" class="sidebar-social-icon linkedin" target="_blank"></a> </div> <ul id="sidebar-tags"> <li class="sidebar-tag active" data-filter="recent">Recent Posts</li> <li class="sidebar-tag" data-filter="tech">tech</li> </ul> </div> <div id="sidebar-right"> <div id="search-box"> <input id="search-input" type="text" placeholder="Search" /> </div> <nav id="toc"> <a class="toc-link" data-tags="tech" href="/2019/05/20/Selenium-with-dynamic-pages.html"> Selenium with dynamic pages </a> </nav> </div> </aside> <main id="main" class="open"> <article class="post container"> <div class="post-meta"> <span class="post-meta-span date">2019 May 20</span> <span class="post-meta-span tag">python</span> </div> <h1 class="post-title">Selenium with dynamic pages</h1> <h1 id="selenium">Selenium</h1> <p>I needed to web scrape a page that wasn’t generated statically. Manually doing so involves selecting several options and fillling forms to make the page generate the elements I needed. The solution to my problem was <a href="https://selenium-python.readthedocs.io/">Selenium</a></p> <h2 id="installations">Installations</h2> <p>Three things to install:</p> <ul> <li> <p><strong>Python-selenium</strong></p> <p>With Anaconda, conda can easily install selenium with dependencies.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda <span class="nb">install</span> <span class="nt">-c</span> conda-forge selenium 
</code></pre></div> </div> <p>Or selenium can also be installed through pip</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>selenium
</code></pre></div> </div> </li> <li> <p>I chose to install <strong>firefox</strong> as my web browser</p> </li> <li> <p><strong>firefox driver</strong> can be downloaded from <a href="[ https://github.com/mozilla/geckodriver/releases](https://github.com/mozilla/geckodriver/releases)">here</a></p> </li> </ul> <p>P.s. when my codes break down, I try to update/install/uninstall the 3 things above. Problems are usually solved :) since they resulted from unmatched software versions</p> <h2 id="selenium-basics">Selenium Basics</h2> <p>As always, I needed to import modules</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
</code></pre></div></div> <p>Before setting up an instance of firefox driver, I specified some details firefox profile .</p> <ol> <li>firefox to never ask me where to save my file</li> <li>firefox to download to my own folder ` download_dir `</li> <li>I wanted the files to be saved as txt’s</li> </ol> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">set_firefox_profile</span><span class="p">(</span><span class="n">download_dir</span><span class="p">):</span>
    <span class="n">firefox_profile</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">FirefoxProfile</span><span class="p">()</span>
    <span class="c1"># dont use default download dir
</span>    <span class="n">firefox_profile</span><span class="o">.</span><span class="n">set_preference</span><span class="p">(</span><span class="s">"browser.download.folderList"</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                                             
    <span class="c1"># set custom download dir
</span>    <span class="n">firefox_profile</span><span class="o">.</span><span class="n">set_preference</span><span class="p">(</span><span class="s">"browser.download.dir"</span><span class="p">,</span><span class="n">download_dir</span><span class="p">)</span>
    <span class="n">firefox_profile</span><span class="o">.</span><span class="n">set_preference</span><span class="p">(</span><span class="s">"browser.helperApps.neverAsk.saveToDisk"</span><span class="p">,</span><span class="s">"text/plain"</span><span class="p">)</span>
    <span class="n">firefox_profile</span><span class="o">.</span><span class="n">set_preference</span><span class="p">(</span><span class="s">"browser.helperApps.alwaysAsk.force"</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'firefox profile set.'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">firefox_profile</span>
</code></pre></div></div> <p>Then, I needed to start a firefox driver with the specified <code class="highlighter-rouge">FIREFOX_PROFILE</code> and <code class="highlighter-rouge">PATH_TO_GECKODRIVER</code></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>driver = webdriver.Firefox(executable_path = PATH_TO_GECKODRIVER, firefox_profile = firefox_profile) 
</code></pre></div></div> <p>The key function I used was to find the HTML element by its CSS selector. There are several other ways to locate an element (by id, name, XPATH, etc. details <a href="https://selenium-python.readthedocs.io/locating-elements.html">4. Locating Elements</a>).</p> <p>Witt the CSS selector and string contents to send to the form, a quick function like this will allow user to fill out a search box</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fill_form</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">item</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">item</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></div> </article> <div class="post-share"> <div class="container"> <a href="https://twitter.com/share?url=http://localhost:4000/2019/05/20/Selenium-with-dynamic-pages.html&text=Selenium with dynamic pages" target="_blank" class="post-share-icon twitter"></a> <a href="https://www.evernote.com/clip.action?url=http://localhost:4000/2019/05/20/Selenium-with-dynamic-pages.html&title=Selenium with dynamic pages" target="_blank" class="post-share-icon evernote"></a> <a href="http://service.weibo.com/share/share.php?url=http://localhost:4000/2019/05/20/Selenium-with-dynamic-pages.html&title=Selenium with dynamic pages" target="_blank" class="post-share-icon weibo"></a> </div> </div> <div class="comment container"> <div id="disqus_thread"> </div> </div> <div class="footer"> <div class="container"> <p class="footer-entry">All content is licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA</a></p> <p class="footer-entry">Built with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and <a href="https://github.com/P233/3-Jekyll" target="_blank">3-Jekyll theme</a> • Hosted on <a href="https://pages.github.com/" target="_blank">Github</a></p> </div> </div> </main> <button id="menu" class="open"> <span id="menu-icons"></span> </button> <button id="post-toc-menu"> <span id="post-toc-menu-icons"></span> </button> <div id="post-toc"> <span id="post-toc-title">Table of Contents</span> <ul id="post-toc-ul"></ul> </div> <script src="/assets/js/jquery-2.1.3.min.js"></script> <script src="/assets/js/jquery.pjax.js"></script> <script src="/assets/js/nprogress.js"></script> <script src="/assets/js/main.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-140141522-1', 'https://yuhsienliu.github.io'); ga('send', 'pageview'); </script> </body> </html>
